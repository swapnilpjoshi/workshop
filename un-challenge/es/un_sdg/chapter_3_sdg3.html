<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. UN SDG3: Good Health and Well Being &#8212; Workshop - FOSS4G 2021 Argentina - Routing with pgRouting</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="4. UN SDG11: Sustainable Cities and Communities" href="chapter_4_sdg11.html" />
    <link rel="prev" title="2. Data for Sustainable Development Goals" href="chapter_2_get_data.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/pgrouting.png"></span>
          Workshop FOSS4G Argentina</a>
        <span class="navbar-text navbar-version pull-left"><b>2.7</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Taller</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-1.html">1. Introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-2.html">2. Sobre El Taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#pgrouting-overview">2.1. Visión General de pgRouting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#osm2pgrouting-overview">2.2. Visión General de osm2pgrouting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#openstreetmap-overview">2.3. Visión general de OpenStreetMap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-3.html">3. Instalación</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-3.html#osgeolive-on-a-virtualbox">3.1. OSGeoLive en una VirtualBox</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basic</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-4.html">1. Preparar Datos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#prepare-the-database">1.1. Preparar la base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#get-the-workshop-data">1.2. Obtenga los Datos del Taller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#upload-data-to-the-database">1.3. Cargar datos en la base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#chapter-appendix">1.4. Capítulo: Apéndice</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-5.html">2. Algoritmos de pgRouting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-5.html#pgr-dijkstra">2.1. pgr_dijkstra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-5.html#pgr-dijkstracost">2.2. pgr_dijkstraCost</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-6.html">3. Consultas avanzadas de ruteo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-6.html#routing-for-vehicles">3.1. Ruteo para vehículos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-6.html#cost-manipulations">3.2. Manipulaciones de costes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-7.html">4. Escribir un Procedimiento Almacenado de SQL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#the-application-requirements">4.1. Los requisitos de aplicación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#preparing-processing-graphs">4.2. Preparación de grafos de procesamiento</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#geometry-handling">4.3. Manejo de geometría</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#creating-the-function">4.4. Crear la función</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-8.html">5. Escribir un pl/pgsql Procedimientos Almacenados</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-8.html#requirements-for-routing-from-a-to-b">5.1. Requisitos para el ruteo de A a B</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-8.html#the-vertex-table">5.2. La Tabla de Vértices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-8.html#wrk-fromatob-function">5.3. función wrk_fromAtoB</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/chapter-12.html">1. Crear una topología de red</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#load-network-data">1.1. Cargar los datos de la red</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#create-a-routing-network-topology">1.2. Crear una Topología de Red de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#verify-the-routing-network-topology">1.3. Verifique la Topología de Red de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#analyze-and-adjust-the-routing-network-topology">1.4. Analizar y ajustar la Topología de Red de Ruteo</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">United Nations Sustainable Development Goals</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chapter_1_introduction.html">1. Achieving Sustainable Development Goals with pgRouting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#history">1.1. History</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#united-nations">1.2. United Nations</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#what-are-the-sustainable-development-goals">1.3. What are the Sustainable Development Goals?</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#target-audience">1.4. Target Audience</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#prerequisites-for-un-sdg-exercises">1.5. Prerequisites for UN SDG Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chapter_2_get_data.html">2. Data for Sustainable Development Goals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chapter_2_get_data.html#work-directory-for-pgrouting-data-manipulation">2.1. Work Directory for pgRouting data manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_2_get_data.html#mumbai-database">2.2. Mumbai database</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_2_get_data.html#bangladesh-database">2.3. Bangladesh database</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. UN SDG3: Good Health and Well Being</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#excercise-3-1-optimal-locations-of-mobile-hospitals">3.1. Excercise 3.1: Optimal locations of mobile hospitals</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chapter_4_sdg11.html">4. UN SDG11: Sustainable Cities and Communities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chapter_4_sdg11.html#excercise-4-1-city-getting-affected-by-rain-or-not">4.1. Excercise 4.1: City getting affected by rain or not</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interaction with other software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-9.html">1. Uso de Qgis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#set-up-qgis">1.1. Configurar QGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#add-a-postgis-layer">1.2. Añadir una Capa postGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#format-a-routing-layer">1.3. Formatear una Capa de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#copy-paste-format">1.4. Copiar/Pegar Formato</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#save-the-project">1.5. Guardar el proyecto</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-10.html">2. Servidor WMS con GeoServer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-10.html#connect-to-the-administration-page">2.1. Conéctese a la página de administración</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-10.html#create-the-layer">2.2. Crear la capa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-11.html">3. Interfaz de Ruteo Basada en OpenLayers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#openlayers-introduction">3.1. Introducción a OpenLayers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#creating-a-minimal-map">3.2. Crear un mapa mínimo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#wms-get-parameters">3.3. Parámetros WMS GET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#select-start-and-destination">3.4. Seleccione «inicio» y «destino»</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#clear-the-results">3.5. Borrar los resultados</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#summary-full-example">3.6. Resumen (ejemplo completo)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples from the Internet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/boost_dijkstra.html">1. Ejemplo de Boost Dijkstra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/hanoslav.html">2. Ejemplos de Internet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/wiki_example.html">3. Wikipedia Dijkstra Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Apéndices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-1.html">1. Apéndice: Soluciones del taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-5">1.1. Solutions to <span class="xref std std-doc">../basic/chapter-5</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-6">1.2. Solutions to <span class="xref std std-doc">../basic/chapter-6</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-7">1.3. Solutions to <span class="xref std std-doc">../basic/chapter-7</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-8">1.4. Solutions to <span class="xref std std-doc">../basic/chapter-8</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-2.html">2. Apéndice: Instalación</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-3.html">3. Apéndice: Herramienta de Importación osm2pgrouting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-4.html">4. Tutoriales en Video para Taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-4.html#chapter-4">4.1. Capítulo 4</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">3. UN SDG3: Good Health and Well Being</a><ul>
<li><a class="reference internal" href="#excercise-3-1-optimal-locations-of-mobile-hospitals">3.1. Excercise 3.1: Optimal locations of mobile hospitals</a><ul>
<li><a class="reference internal" href="#setting-the-search-path">3.1.1. Setting the Search Path</a></li>
<li><a class="reference internal" href="#counting-the-number-of-roads-and-buildings">3.1.2. Counting the number of Roads and Buildings</a></li>
<li><a class="reference internal" href="#preprocessing-buildings">3.1.3. Preprocessing Buildings</a></li>
<li><a class="reference internal" href="#process-to-discard-disconnected-roads">3.1.4. Process to discard disconnected roads</a></li>
<li><a class="reference internal" href="#calculating-the-population-residing-along-the-road">3.1.5. Calculating the population residing along the road</a></li>
<li><a class="reference internal" href="#estimating-the-population-of-buildings">3.1.6. Estimating the population of buildings</a></li>
<li><a class="reference internal" href="#todo-calculating-the-population-residing-along-the-road">3.1.7. TODO Calculating the population residing along the road</a></li>
<li><a class="reference internal" href="#finding-out-optimal-locations-of-mobile-hospitals">3.1.8. Finding out optimal locations of mobile hospitals</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="chapter_2_get_data.html" title="Previous Chapter: 2. Data for Sustainable Development Goals"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 2. Data for S...</span>
    </a>
  </li>
  <li>
    <a href="chapter_4_sdg11.html" title="Next Chapter: 4. UN SDG11: Sustainable Cities and Communities"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">4. UN SDG11: ... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="un-sdg3-good-health-and-well-being">
<h1><a class="toc-backref" href="#id1"><span class="section-number">3. </span>UN SDG3: Good Health and Well Being</a><a class="headerlink" href="#un-sdg3-good-health-and-well-being" title="Enlazar permanentemente con este título">¶</a></h1>
<p>SDG 3 aspires to ensure health and well-being for all, including a bold
commitment to end the epidemics of AIDS, tuberculosis, malaria and other
communicable diseases by 2030. It also aims to achieve universal health
coverage, and provide access to safe and effective medicines and vaccines for
all. Supporting research and development for vaccines is an essential part of
this process as well as expanding access to affordable medicines.</p>
<img alt="../_images/un_sdg3.png" class="align-center" src="../_images/un_sdg3.png" />
<div class="contents topic" id="chapter-contents">
<p class="topic-title">Chapter Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#un-sdg3-good-health-and-well-being" id="id1">UN SDG3: Good Health and Well Being</a></p>
<ul>
<li><p><a class="reference internal" href="#excercise-3-1-optimal-locations-of-mobile-hospitals" id="id2">Excercise 3.1: Optimal locations of mobile hospitals</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-the-search-path" id="id3">Setting the Search Path</a></p></li>
<li><p><a class="reference internal" href="#counting-the-number-of-roads-and-buildings" id="id4">Counting the number of Roads and Buildings</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-buildings" id="id5">Preprocessing Buildings</a></p></li>
<li><p><a class="reference internal" href="#process-to-discard-disconnected-roads" id="id6">Process to discard disconnected roads</a></p></li>
<li><p><a class="reference internal" href="#calculating-the-population-residing-along-the-road" id="id7">Calculating the population residing along the road</a></p></li>
<li><p><a class="reference internal" href="#estimating-the-population-of-buildings" id="id8">Estimating the population of buildings</a></p></li>
<li><p><a class="reference internal" href="#todo-calculating-the-population-residing-along-the-road" id="id9">TODO Calculating the population residing along the road</a></p></li>
<li><p><a class="reference internal" href="#finding-out-optimal-locations-of-mobile-hospitals" id="id10">Finding out optimal locations of mobile hospitals</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="excercise-3-1-optimal-locations-of-mobile-hospitals">
<h2><a class="toc-backref" href="#id2"><span class="section-number">3.1. </span>Excercise 3.1: Optimal locations of mobile hospitals</a><a class="headerlink" href="#excercise-3-1-optimal-locations-of-mobile-hospitals" title="Enlazar permanentemente con este título">¶</a></h2>
<p><strong>Problem Statement</strong></p>
<ul class="simple">
<li><p>To determine the optimal locations of Hospitals</p></li>
</ul>
<p><strong>Core Idea</strong></p>
<ul class="simple">
<li><p>More Hospitals will be required at places where a higher no. of people are living.</p></li>
</ul>
<p><strong>Approach</strong></p>
<ul class="simple">
<li><p>To prepare a dataset with:</p>
<ul>
<li><p>Nodes: Probable hospital locations</p></li>
<li><p>Edges: Roads</p></li>
<li><p>Polygons: Buildings with population</p></li>
</ul>
</li>
<li><p>Estimate the population of the buildings</p></li>
<li><p>Find the nearest road to the buildings</p></li>
<li><p>Store the sum of population of nearest buildings in roads table</p></li>
<li><p>pgRouting query to find out most optimal locations (Cost will be proportional
to population residing by the roads)</p></li>
</ul>
<p>First step is to pre-process the data obtained from Chapter-2. The sub heads from
<cite>Setting the Search Path</cite> to <cite>Process to discard disconnected roads</cite> explain the
pre-processing steps.</p>
<section id="setting-the-search-path">
<h3><a class="toc-backref" href="#id3"><span class="section-number">3.1.1. </span>Setting the Search Path</a><a class="headerlink" href="#setting-the-search-path" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Set the search path of the <cite>Roads</cite> and <cite>Buildings</cite> to their respective schemas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">--</span> <span class="n">Enumerate</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">schemas</span>
<span class="linenos"> 2</span>\<span class="n">dn</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="o">--</span> <span class="n">Show</span> <span class="n">the</span> <span class="n">current</span> <span class="n">search</span> <span class="n">path</span>
<span class="linenos"> 6</span><span class="n">SHOW</span> <span class="n">search_path</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="o">--</span> <span class="n">Set</span> <span class="n">the</span> <span class="n">search</span> <span class="n">path</span>
<span class="linenos"> 9</span><span class="n">SET</span> <span class="n">search_path</span> <span class="n">TO</span> <span class="n">roads</span><span class="p">,</span><span class="n">buildings</span><span class="p">,</span><span class="n">public</span><span class="p">;</span>
<span class="linenos">10</span><span class="n">SHOW</span> <span class="n">search_path</span><span class="p">;</span>
<span class="linenos">11</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="o">--</span> <span class="n">Enumerate</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">tables</span>
<span class="linenos">14</span>\<span class="n">dt</span>
<span class="linenos">15</span>
</pre></div>
</div>
</section>
<section id="counting-the-number-of-roads-and-buildings">
<h3><a class="toc-backref" href="#id4"><span class="section-number">3.1.2. </span>Counting the number of Roads and Buildings</a><a class="headerlink" href="#counting-the-number-of-roads-and-buildings" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Display the number of roads and buildings which were imported in Chapter 2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">--</span> <span class="n">Counting</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">Edges</span> <span class="n">of</span> <span class="n">roads</span>
<span class="linenos"> 2</span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">roads_ways</span><span class="p">;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="o">--</span> <span class="n">Counting</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">Vertices</span> <span class="n">of</span> <span class="n">roads</span>
<span class="linenos"> 5</span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">roads_ways_vertices_pgr</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="o">--</span> <span class="n">Counting</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">buildings</span> 
<span class="linenos"> 9</span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">buildings_ways</span><span class="p">;</span>
<span class="linenos">10</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="o">--</span> <span class="n">Showing</span> <span class="n">the</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span>
<span class="linenos">13</span>\<span class="n">dS</span><span class="o">+</span> <span class="n">buildings_ways</span>
<span class="linenos">14</span>
<span class="linenos">15</span>
</pre></div>
</div>
</section>
<section id="preprocessing-buildings">
<h3><a class="toc-backref" href="#id5"><span class="section-number">3.1.3. </span>Preprocessing Buildings</a><a class="headerlink" href="#preprocessing-buildings" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Polygons with less than 3 points/vertices are not considered valid polygons in PostgreSQL. Hence, they need to be cleaned up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>
<span class="linenos"> 2</span>--Add a spatial column to the table
<span class="linenos"> 3</span>SELECT AddGeometryColumn (&#39;buildings&#39;,&#39;buildings_ways&#39;,&#39;poly_geom&#39;,4326,&#39;POLYGON&#39;,2);
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>-- Removing the geometries that are not polygons 
<span class="linenos"> 7</span>DELETE FROM buildings_ways 
<span class="linenos"> 8</span>WHERE ST_NumPoints(the_geom) &lt; 4 
<span class="linenos"> 9</span>OR ST_IsClosed(the_geom) = false;
<span class="linenos">10</span>
<span class="linenos">11</span>
<span class="linenos">12</span>-- Creating the polygons
<span class="linenos">13</span>UPDATE buildings_ways 
<span class="linenos">14</span>SET poly_geom = ST_MakePolygon(the_geom);
<span class="linenos">15</span>
<span class="linenos">16</span>
<span class="linenos">17</span>
<span class="linenos">18</span>\o buildings_population_calculation.txt
<span class="linenos">19</span>-- Adding a column for storing the area
<span class="linenos">20</span>ALTER TABLE buildings_ways
<span class="linenos">21</span>ADD COLUMN area INTEGER;
<span class="linenos">22</span>
<span class="linenos">23</span>
<span class="linenos">24</span>-- Calculating the area
<span class="linenos">25</span>UPDATE buildings_ways 
<span class="linenos">26</span>SET area = ST_Area(poly_geom::geography)::INTEGER;
<span class="linenos">27</span>
<span class="linenos">28</span>
<span class="linenos">29</span>
<span class="linenos">30</span>
<span class="linenos">31</span>-- UN SDG3: Good Health and Well Being
<span class="linenos">32</span>
<span class="linenos">33</span>-- Function for computing the population based on the area of the polygon
<span class="linenos">34</span>
<span class="linenos">35</span>-- Negligible: People donot live in these places. But the default is 1 because of homeless people.
<span class="linenos">36</span>-- Very Sparse: People donot live in these places. But the deafault is 2 because there may be people guarding the place.
<span class="linenos">37</span>-- Sparse: Considering the universities and college because the students live there.
<span class="linenos">38</span>-- Moderate: A family unit housing kind of location.
<span class="linenos">39</span>-- Dense: A meduim sized residential building.
<span class="linenos">40</span>-- Very Dense: A large sized resiential building.
<span class="linenos">41</span>-- All these are estimations based on this particular area. 
<span class="linenos">42</span>-- More complicated functions can be done that consider height of the apartments but the design of a function is 
<span class="linenos">43</span>-- going to depend on the availability of the data. For example, using census data can achieve more accurate estimation.
<span class="linenos">44</span>
<span class="linenos">45</span>-- population_function_from_here
<span class="linenos">46</span>
<span class="linenos">47</span>CREATE OR REPLACE FUNCTION  population(tag_id INTEGER,area INTEGER)
<span class="linenos">48</span>RETURNS INTEGER AS 
<span class="linenos">49</span>$BODY$
<span class="linenos">50</span>DECLARE 
<span class="linenos">51</span>population INTEGER;
<span class="linenos">52</span>BEGIN 
<span class="linenos">53</span>  IF tag_id &lt;= 100 THEN population = 1; -- Negligible
<span class="linenos">54</span>  ELSIF 100 &lt; tag_id AND tag_id &lt;= 200 THEN  population = GREATEST(2, area * 0.0002); -- Very Sparse
<span class="linenos">55</span>  ELSIF 200 &lt; tag_id AND tag_id &lt;= 300 THEN  population = GREATEST(3, area * 0.002); -- Sparse
<span class="linenos">56</span>  ELSIF 300 &lt; tag_id AND tag_id &lt;= 400 THEN population = GREATEST(5,  area * 0.05); -- Moderate
<span class="linenos">57</span>  ELSIF 400 &lt; tag_id AND tag_id &lt;= 500  THEN population = GREATEST(7, area * 0.7); -- Dense
<span class="linenos">58</span>  ELSIF tag_id &gt; 500  THEN population = GREATEST(10,area * 1); -- Very Dense
<span class="linenos">59</span>  ELSE population = 1;
<span class="linenos">60</span>  END IF;
<span class="linenos">61</span>  RETURN population;
<span class="linenos">62</span>END;
<span class="linenos">63</span>$BODY$
<span class="linenos">64</span>LANGUAGE plpgsql;
<span class="linenos">65</span>
<span class="linenos">66</span>-- Adding a column for storing the population
<span class="linenos">67</span>ALTER TABLE buildings_ways
<span class="linenos">68</span>ADD COLUMN population INTEGER;
<span class="linenos">69</span>
<span class="linenos">70</span>
<span class="linenos">71</span>-- Storing the population
<span class="linenos">72</span>UPDATE buildings_ways 
<span class="linenos">73</span>SET population = population(tag_id,area)::INTEGER;
<span class="linenos">74</span>
<span class="linenos">75</span>-- population_function_to_here
<span class="linenos">76</span>
</pre></div>
</div>
</section>
<section id="process-to-discard-disconnected-roads">
<h3><a class="toc-backref" href="#id6"><span class="section-number">3.1.4. </span>Process to discard disconnected roads</a><a class="headerlink" href="#process-to-discard-disconnected-roads" title="Enlazar permanentemente con este título">¶</a></h3>
<p>pgRouting algorithms are only useful when the road netowrk belongs to a single graph (or all the roads are connected to each other). Hence, the disconnected roads have to be removed from ther network to get accurate results.
This image gives an example of the diconnected edges.</p>
<p>..image:: /images/Entry_points_of_proposed_locations.png
:align: center</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">-- Add a column for storing the component</span>
<span class="linenos"> 2</span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">roads_ways_vertices_pgr</span>
<span class="linenos"> 3</span><span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">component</span> <span class="nb">INTEGER</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1">-- Update the vertices with the component number</span>
<span class="linenos"> 6</span><span class="k">UPDATE</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">set</span> <span class="n">component</span> <span class="o">=</span> <span class="n">subquery</span><span class="p">.</span><span class="n">component</span>
<span class="linenos"> 7</span><span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pgr_connectedComponents</span><span class="p">(</span><span class="s1">&#39;SELECT gid AS id, source, target, cost, reverse_cost FROM roads_ways&#39;</span><span class="p">))</span> <span class="k">AS</span> <span class="n">subquery</span>
<span class="linenos"> 8</span><span class="k">WHERE</span> <span class="n">id</span> <span class="o">=</span> <span class="n">node</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1">-- These components are to be removed</span>
<span class="linenos">11</span><span class="k">WITH</span>
<span class="linenos">12</span><span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span><span class="p">)</span>
<span class="linenos">13</span><span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> <span class="k">where</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="c1">-- The edges that need to be removed</span>
<span class="linenos">16</span><span class="k">WITH</span>
<span class="linenos">17</span><span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span><span class="p">),</span>
<span class="linenos">18</span><span class="n">to_remove</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> <span class="k">where</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">))</span>
<span class="linenos">19</span><span class="k">SELECT</span> <span class="n">id</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">WHERE</span> <span class="n">component</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">to_remove</span><span class="p">);</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="c1">-- Removing the unwanted edges</span>
<span class="linenos">22</span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">roads_ways</span> <span class="k">WHERE</span> <span class="k">source</span> <span class="k">IN</span> <span class="p">(</span>
<span class="linenos">23</span><span class="k">WITH</span>
<span class="linenos">24</span><span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span><span class="p">),</span>
<span class="linenos">25</span><span class="n">to_remove</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> <span class="k">where</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">))</span>
<span class="linenos">26</span><span class="k">SELECT</span> <span class="n">id</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">WHERE</span> <span class="n">component</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">to_remove</span><span class="p">)</span>
<span class="linenos">27</span><span class="p">);</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="c1">-- Deleting unused vertices</span>
<span class="linenos">30</span><span class="k">WITH</span>
<span class="linenos">31</span><span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span><span class="p">),</span>
<span class="linenos">32</span><span class="n">to_remove</span> <span class="k">AS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> <span class="k">where</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">))</span>
<span class="linenos">33</span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> <span class="k">WHERE</span> <span class="n">component</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">to_remove</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="calculating-the-population-residing-along-the-road">
<h3><a class="toc-backref" href="#id7"><span class="section-number">3.1.5. </span>Calculating the population residing along the road</a><a class="headerlink" href="#calculating-the-population-residing-along-the-road" title="Enlazar permanentemente con este título">¶</a></h3>
<p>More hospitals are needed in the areas where more people live. To solve this problem we will first have to estimate the population of each building.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>
<span class="linenos"> 2</span>-- Calculating the population residing along the road
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>-- nearest_road_from_here
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>-- Create Function for finding the nearest edge
<span class="linenos"> 7</span>CREATE OR REPLACE FUNCTION closest_edge(geom GEOMETRY)
<span class="linenos"> 8</span>RETURNS BIGINT AS
<span class="linenos"> 9</span>$BODY$
<span class="linenos">10</span>SELECT gid FROM roads_ways ORDER BY geom &lt;-&gt; the_geom LIMIT 1;
<span class="linenos">11</span>$BODY$
<span class="linenos">12</span>LANGUAGE SQL;
<span class="linenos">13</span>
<span class="linenos">14</span>-- Add a column for storing the nearest edge
<span class="linenos">15</span>ALTER TABLE buildings_ways
<span class="linenos">16</span>ADD COLUMN edge_id INTEGER;
<span class="linenos">17</span>
<span class="linenos">18</span>-- Store the edge_id of the nearest edge in the column
<span class="linenos">19</span>UPDATE buildings_ways SET edge_id = closest_edge(poly_geom);
<span class="linenos">20</span>
<span class="linenos">21</span>-- nearest_road_to_here
<span class="linenos">22</span>
<span class="linenos">23</span>-- road_population_from_here
<span class="linenos">24</span>
<span class="linenos">25</span>-- Add population column to roads table
<span class="linenos">26</span>ALTER TABLE roads_ways
<span class="linenos">27</span>ADD COLUMN population INTEGER;
<span class="linenos">28</span>
<span class="linenos">29</span>-- Update the roads with the sum of population of buildings nearest to it
<span class="linenos">30</span>UPDATE roads_ways set population = sum
<span class="linenos">31</span>FROM (SELECT edge_id, sum(population) FROM buildings_ways GROUP BY edge_id) AS subquery
<span class="linenos">32</span>WHERE gid = edge_id;                                                                                                              
<span class="linenos">33</span>               
<span class="linenos">34</span>-- testing
<span class="linenos">35</span>SELECT population FROM roads_ways WHERE gid = 441;
<span class="linenos">36</span>
<span class="linenos">37</span>
<span class="linenos">38</span>-- road_population_to_here
<span class="linenos">39</span>
<span class="linenos">40</span>
<span class="linenos">41</span>
<span class="linenos">42</span>
<span class="linenos">43</span>
<span class="linenos">44</span>
<span class="linenos">45</span>
<span class="linenos">46</span>
<span class="linenos">47</span>
<span class="linenos">48</span>
<span class="linenos">49</span>
<span class="linenos">50</span>
<span class="linenos">51</span>
<span class="linenos">52</span>
<span class="linenos">53</span>
<span class="linenos">54</span>
<span class="linenos">55</span>
<span class="linenos">56</span>
<span class="linenos">57</span>
<span class="linenos">58</span>
</pre></div>
</div>
</section>
<section id="estimating-the-population-of-buildings">
<h3><a class="toc-backref" href="#id8"><span class="section-number">3.1.6. </span>Estimating the population of buildings</a><a class="headerlink" href="#estimating-the-population-of-buildings" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Population of an building can be estimated by its area and its categoyr.
Buildings of OpenStreetMap data are classified into various categories. For
this excercise, the buildings are classified into the following classes:</p>
<ul class="simple">
<li><p>Negligible: People donot live in these places. But the default is 1 because of
homeless people.</p></li>
<li><p>Very Sparse: People donot live in these places. But the deafault is 2 because
there may be people guarding the place.</p></li>
<li><p>Sparse: Considering the universities and college because the students live there.</p></li>
<li><p>Moderate: A family unit housing kind of location.</p></li>
<li><p>Dense: A meduim sized residential building.</p></li>
<li><p>Very Dense: A large sized resiential building.</p></li>
</ul>
<p>The class-specific factor is multiplied with the area of each building to get
the population</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>
<span class="linenos"> 2</span>CREATE OR REPLACE FUNCTION  population(tag_id INTEGER,area INTEGER)
<span class="linenos"> 3</span>RETURNS INTEGER AS 
<span class="linenos"> 4</span>$BODY$
<span class="linenos"> 5</span>DECLARE 
<span class="linenos"> 6</span>population INTEGER;
<span class="linenos"> 7</span>BEGIN 
<span class="linenos"> 8</span>  IF tag_id &lt;= 100 THEN population = 1; -- Negligible
<span class="linenos"> 9</span>  ELSIF 100 &lt; tag_id AND tag_id &lt;= 200 THEN  population = GREATEST(2, area * 0.0002); -- Very Sparse
<span class="linenos">10</span>  ELSIF 200 &lt; tag_id AND tag_id &lt;= 300 THEN  population = GREATEST(3, area * 0.002); -- Sparse
<span class="linenos">11</span>  ELSIF 300 &lt; tag_id AND tag_id &lt;= 400 THEN population = GREATEST(5,  area * 0.05); -- Moderate
<span class="linenos">12</span>  ELSIF 400 &lt; tag_id AND tag_id &lt;= 500  THEN population = GREATEST(7, area * 0.7); -- Dense
<span class="linenos">13</span>  ELSIF tag_id &gt; 500  THEN population = GREATEST(10,area * 1); -- Very Dense
<span class="linenos">14</span>  ELSE population = 1;
<span class="linenos">15</span>  END IF;
<span class="linenos">16</span>  RETURN population;
<span class="linenos">17</span>END;
<span class="linenos">18</span>$BODY$
<span class="linenos">19</span>LANGUAGE plpgsql;
<span class="linenos">20</span>
<span class="linenos">21</span>-- Adding a column for storing the population
<span class="linenos">22</span>ALTER TABLE buildings_ways
<span class="linenos">23</span>ADD COLUMN population INTEGER;
<span class="linenos">24</span>
<span class="linenos">25</span>
<span class="linenos">26</span>-- Storing the population
<span class="linenos">27</span>UPDATE buildings_ways 
<span class="linenos">28</span>SET population = population(tag_id,area)::INTEGER;
<span class="linenos">29</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>All these are estimations based on this particular area. More complicated
functions can be done that consider height of the apartments but the design
of a function is going to depend on the availability of the data. For example,
using census data can achieve more accurate estimation.</p>
</div>
</section>
<section id="todo-calculating-the-population-residing-along-the-road">
<h3><a class="toc-backref" href="#id9"><span class="section-number">3.1.7. </span>TODO Calculating the population residing along the road</a><a class="headerlink" href="#todo-calculating-the-population-residing-along-the-road" title="Enlazar permanentemente con este título">¶</a></h3>
<p>To store the population of buildigs in the roads, nearest road to a building
is to be found.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>
<span class="linenos"> 2</span>-- Create Function for finding the nearest edge
<span class="linenos"> 3</span>CREATE OR REPLACE FUNCTION closest_edge(geom GEOMETRY)
<span class="linenos"> 4</span>RETURNS BIGINT AS
<span class="linenos"> 5</span>$BODY$
<span class="linenos"> 6</span>SELECT gid FROM roads_ways ORDER BY geom &lt;-&gt; the_geom LIMIT 1;
<span class="linenos"> 7</span>$BODY$
<span class="linenos"> 8</span>LANGUAGE SQL;
<span class="linenos"> 9</span>
<span class="linenos">10</span>-- Add a column for storing the nearest edge
<span class="linenos">11</span>ALTER TABLE buildings_ways
<span class="linenos">12</span>ADD COLUMN edge_id INTEGER;
<span class="linenos">13</span>
<span class="linenos">14</span>-- Store the edge_id of the nearest edge in the column
<span class="linenos">15</span>UPDATE buildings_ways SET edge_id = closest_edge(poly_geom);
<span class="linenos">16</span>
</pre></div>
</div>
<p>After finding the nearest road, the sum of population of all the nearest
buildings is stored in the population column of the roads table</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>
<span class="linenos"> 2</span><span class="o">--</span> <span class="n">Add</span> <span class="n">population</span> <span class="n">column</span> <span class="n">to</span> <span class="n">roads</span> <span class="n">table</span>
<span class="linenos"> 3</span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">roads_ways</span>
<span class="linenos"> 4</span><span class="n">ADD</span> <span class="n">COLUMN</span> <span class="n">population</span> <span class="n">INTEGER</span><span class="p">;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="o">--</span> <span class="n">Update</span> <span class="n">the</span> <span class="n">roads</span> <span class="k">with</span> <span class="n">the</span> <span class="nb">sum</span> <span class="n">of</span> <span class="n">population</span> <span class="n">of</span> <span class="n">buildings</span> <span class="n">nearest</span> <span class="n">to</span> <span class="n">it</span>
<span class="linenos"> 7</span><span class="n">UPDATE</span> <span class="n">roads_ways</span> <span class="nb">set</span> <span class="n">population</span> <span class="o">=</span> <span class="nb">sum</span>
<span class="linenos"> 8</span><span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">edge_id</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">buildings_ways</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">edge_id</span><span class="p">)</span> <span class="n">AS</span> <span class="n">subquery</span>
<span class="linenos"> 9</span><span class="n">WHERE</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">edge_id</span><span class="p">;</span>                                                                                                              
<span class="linenos">10</span>               
<span class="linenos">11</span><span class="o">--</span> <span class="n">testing</span>
<span class="linenos">12</span><span class="n">SELECT</span> <span class="n">population</span> <span class="n">FROM</span> <span class="n">roads_ways</span> <span class="n">WHERE</span> <span class="n">gid</span> <span class="o">=</span> <span class="mi">441</span><span class="p">;</span>
<span class="linenos">13</span>
<span class="linenos">14</span>
</pre></div>
</div>
</section>
<section id="finding-out-optimal-locations-of-mobile-hospitals">
<h3><a class="toc-backref" href="#id10"><span class="section-number">3.1.8. </span>Finding out optimal locations of mobile hospitals</a><a class="headerlink" href="#finding-out-optimal-locations-of-mobile-hospitals" title="Enlazar permanentemente con este título">¶</a></h3>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2021 Daniel Kastl, Vicky Vergara.<br/>
      Actualizado por última vez en sept. 08, 2021.<br/>
    </p>
  </div>
</footer>
  </body>
</html>